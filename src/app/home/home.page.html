<ion-header [translucent]="true">
  <ion-toolbar color="primary">
    <ion-buttons slot="start">
      <ion-menu-button />
    </ion-buttons>
    <ion-title>PetCare+</ion-title>
  </ion-toolbar>
</ion-header>

<ion-content [fullscreen]="true" class="ion-padding">
  <ion-card class="welcome-card" *ngIf="user$ | async as user" @fadeIn>
    <ion-card-header>
      <ion-card-title>Hola, {{ user.fullName.split(' ')[0] || user.fullName }} ðŸ‘‹</ion-card-title>
      <ion-card-subtitle>Gestiona el cuidado de tus mascotas desde un solo lugar.</ion-card-subtitle>
    </ion-card-header>
  </ion-card>

  <ion-card class="pet-card" *ngIf="pet$ | async as pet; else emptyPet" @fadeIn>
    <ion-card-header>
      <ion-card-title>{{ pet.name }}</ion-card-title>
      <ion-card-subtitle>{{ pet.species }} â€¢ {{ pet.breed }}</ion-card-subtitle>
    </ion-card-header>
    <ion-card-content>
      <div class="pet-details">
        <ion-avatar>
          <img [src]="pet.avatarUrl || 'https://ionicframework.com/docs/img/demos/avatar.svg'" alt="Mascota" />
        </ion-avatar>
        <ul>
          <li>Peso: {{ pet.weight }} kg</li>
          <li>Edad: {{ getPetAge(pet.birthDate) }}</li>
          <li>Veterinario: {{ pet.vetName }} ({{ pet.vetPhone }})</li>
        </ul>
      </div>
      <ion-button fill="clear" color="tertiary" (click)="goTo('/pet-profile')">
        Actualizar informaciÃ³n
      </ion-button>
    </ion-card-content>
  </ion-card>

  <ng-template #emptyPet>
    <ion-card class="pet-card" @fadeIn>
      <ion-card-header>
        <ion-card-title>Perfil pendiente</ion-card-title>
      </ion-card-header>
      <ion-card-content>
        <p>
          Registra los datos principales de tu mascota para personalizar recordatorios y emergencias.
        </p>
        <ion-button expand="block" color="secondary" (click)="goTo('/pet-profile')">
          Registrar mascota
        </ion-button>
      </ion-card-content>
    </ion-card>
  </ng-template>

  <ion-card class="quick-actions" @fadeIn>
    <ion-card-header>
      <ion-card-title>Accesos rÃ¡pidos</ion-card-title>
    </ion-card-header>
    <ion-card-content>
      <ion-grid>
        <ion-row>
          <ion-col size="6">
            <ion-button expand="block" color="primary" (click)="goTo('/care-calendar')">
              <ion-icon slot="start" name="calendar"></ion-icon>
              Calendario
            </ion-button>
          </ion-col>
          <ion-col size="6">
            <ion-button expand="block" color="danger" (click)="goTo('/emergencies')">
              <ion-icon slot="start" name="medkit"></ion-icon>
              Emergencias
            </ion-button>
          </ion-col>
        </ion-row>
        <ion-row>
          <ion-col size="12">
            <ion-button expand="block" color="success" (click)="goTo('/community')">
              <ion-icon slot="start" name="navigate"></ion-icon>
              Servicios cercanos
            </ion-button>
          </ion-col>
        </ion-row>
      </ion-grid>
    </ion-card-content>
  </ion-card>

  <ion-card class="reminders-card" @fadeIn>
    <ion-card-header>
      <ion-card-title>PrÃ³ximos cuidados</ion-card-title>
      <ion-card-subtitle>Registra y marca los cuidados completados</ion-card-subtitle>
    </ion-card-header>
    <ion-card-content>
      <ion-list>
        <ion-item
          button
          detail="false"
          *ngFor="let reminder of reminders$ | async; trackBy: trackByReminder"
          (click)="toggleReminder(reminder.id)"
        >
          <ion-icon
            slot="start"
            [color]="reminder.completed ? 'success' : 'medium'"
            [name]="reminder.completed ? 'checkmark-circle' : 'ellipse-outline'"
          ></ion-icon>
          <ion-label>
            <h2>{{ reminder.title }}</h2>
            <p>{{ reminder.type }} â€¢ {{ reminder.scheduledDate | date: 'd MMM yyyy':'':'es' }}</p>
          </ion-label>
        </ion-item>
      </ion-list>
      <ion-button expand="block" color="primary" fill="outline" (click)="goTo('/care-calendar')">
        Gestionar recordatorios
      </ion-button>
    </ion-card-content>
  </ion-card>
</ion-content>
